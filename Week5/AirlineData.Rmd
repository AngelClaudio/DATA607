---
title: "Airline Data Wrangling"
author: "Angel Claudio"

output: 
    html_document: 
        toc: true
        toc_depth: 2
        toc_float: true
        number_sections: true
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(magrittr)
library(DT)
```

# Extract

**Pulled raw data from a public endpoint and renamed columns for readability.**

```{r Extract, warning=F, message=F}
(flights <- 
     read_csv("https://raw.githubusercontent.com/AngelClaudio/DataSources/master/Flights.csv")
     %>% rename(Airline = X1, Status = X2)) 
```

# Tidy and Transform

**Here I replaced the NA values with the preceding values (Airlines). Next I removed the row with the NA values. Lastly I Unpivoted variables to use as values.**

```{r TnT}
datatable(flights %<>% fill(Airline) %>%drop_na() %>% gather("Port", "Total_Flights", 3:7))       
```

# Data Analysis

**Get average of flights delayed for each airline.**

1. Group by Airline & Status
2. Get the sum of total flights for each
3. Using the sum of the total flights derived, divided by the sum of the totals for each group (airlines)

```{r RnA}
    datatable(group_by(flights, Airline, Status) %>% summarise(Total = sum(Total_Flights)) %>%
                mutate(Percent = round(Total/sum(Total),2)),)
```

# Conclusion and Visualization

**Although the delayed flights per region in Alaska Airlines were higher, it's misleading of their overrall performance in comparision because we can see by proportion AM West has a lower delay percentage by 2 percent.**

**Using visualizations we can now see that they seem to have in common the relationship where as the number of flights increase, so does the relative amount of delays. You can see this holds true for Seattle flights for ALASKA airlines and Phoenix flights for AM WEST.**

**Maybe we can make a preliminary inference that as the flight paths become more crowded the risk of delays goes up.**

```{r}
ggplot(filter(flights, Airline=="ALASKA")) + 
    geom_bar(aes(reorder(x = Port, -Total_Flights), y = Total_Flights, fill = Status),
             stat = 'identity') + ylim(0,5000) +
    ggtitle("ALASKA Airlines On Times vs Delays ") + xlab("Ports")

ggplot(filter(flights, Airline=="AM WEST")) + 
    geom_bar(aes(reorder(x = Port, -Total_Flights), y = Total_Flights, fill = Status),
             stat = 'identity') + ggtitle("AM WEST Airlines On Times vs Delays") + xlab("Ports")
```


